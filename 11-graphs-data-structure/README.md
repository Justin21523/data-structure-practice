# 第十一章：圖的表示法（Graph Data Structures）

本章介紹圖（graph）的各種表示方法。圖是由頂點（vertex）與邊（edge）組成的資料結構，廣泛應用於社交網路、地圖導航、網路拓撲等領域。

**注意**：本章專注於圖的「儲存與表示」，圖的演算法（如 BFS、DFS、最短路徑）請參考 `tw-gradcs-algorithms` repository。

## 學習目標

- 理解圖的基本術語與分類
- 掌握不同表示法的實作與特性
- 學會根據問題需求選擇適當的表示法

## 單元列表

| 單元 | 主題 | 說明 |
|------|------|------|
| 01 | [鄰接矩陣](./01-adjacency-matrix/) | 二維陣列表示法 |
| 02 | [鄰接串列](./02-adjacency-list/) | 串列表示法 |
| 03 | [邊列表](./03-edge-list/) | 邊的集合表示法 |

## 圖的基本術語

```
無向圖範例:               有向圖範例:
    A --- B                  A → B
    |   / |                  ↓   ↓
    |  /  |                  C → D
    C --- D
```

| 術語 | 英文 | 說明 |
|------|------|------|
| 頂點 | vertex / node | 圖中的節點 |
| 邊 | edge | 連接兩頂點的線 |
| 有向圖 | directed graph | 邊有方向 |
| 無向圖 | undirected graph | 邊無方向 |
| 加權圖 | weighted graph | 邊有權重 |
| 度數 | degree | 與頂點相連的邊數 |
| 入度 | in-degree | 指向該頂點的邊數（有向圖） |
| 出度 | out-degree | 從該頂點出發的邊數（有向圖） |
| 路徑 | path | 頂點序列，相鄰頂點間有邊 |
| 環 | cycle | 起點與終點相同的路徑 |
| 連通圖 | connected graph | 任兩頂點間都有路徑 |
| 稀疏圖 | sparse graph | 邊數遠少於 V² |
| 稠密圖 | dense graph | 邊數接近 V² |

## 三種表示法

### 1. 鄰接矩陣（Adjacency Matrix）

使用 V×V 的二維陣列，`A[i][j]` 表示頂點 i 到 j 是否有邊。

```
圖:                    鄰接矩陣:
    0 --- 1              0  1  2  3
    |   / |           0 [0, 1, 1, 0]
    |  /  |           1 [1, 0, 1, 1]
    2 --- 3           2 [1, 1, 0, 1]
                      3 [0, 1, 1, 0]
```

### 2. 鄰接串列（Adjacency List）

每個頂點維護一個相鄰頂點的串列。

```
圖:                    鄰接串列:
    0 --- 1            0: [1, 2]
    |   / |            1: [0, 2, 3]
    |  /  |            2: [0, 1, 3]
    2 --- 3            3: [1, 2]
```

### 3. 邊列表（Edge List）

儲存所有邊的集合。

```
圖:                    邊列表:
    0 --- 1            [(0,1), (0,2), (1,2), (1,3), (2,3)]
    |   / |
    |  /  |
    2 --- 3
```

## 表示法比較

| 操作 | 鄰接矩陣 | 鄰接串列 | 邊列表 |
|------|---------|---------|--------|
| 空間 | O(V²) | O(V+E) | O(E) |
| 檢查邊存在 | O(1) | O(degree) | O(E) |
| 遍歷所有邊 | O(V²) | O(V+E) | O(E) |
| 新增邊 | O(1) | O(1) | O(1) |
| 刪除邊 | O(1) | O(degree) | O(E) |
| 取得相鄰頂點 | O(V) | O(degree) | O(E) |

### 選擇指南

| 圖的類型 | 建議表示法 | 原因 |
|---------|-----------|------|
| 稠密圖 | 鄰接矩陣 | 空間差異小，查詢快 |
| 稀疏圖 | 鄰接串列 | 節省空間 |
| 需頻繁檢查邊 | 鄰接矩陣 | O(1) 查詢 |
| 需遍歷相鄰頂點 | 鄰接串列 | 效率高 |
| Kruskal 演算法 | 邊列表 | 需對邊排序 |

## 加權圖的表示

### 鄰接矩陣

```
A[i][j] = 邊 (i,j) 的權重
        = ∞ 若無邊
        = 0 若 i = j
```

### 鄰接串列

```
adj[i] = [(j₁, w₁), (j₂, w₂), ...]
其中 wₖ 是邊 (i, jₖ) 的權重
```

### 邊列表

```
edges = [(u₁, v₁, w₁), (u₂, v₂, w₂), ...]
```

## 實作考量

### 頂點標籤

若頂點不是連續整數，可使用：
- 雜湊表將標籤對應到索引
- 直接使用雜湊表作為鄰接結構

### 多重邊與自環

| 結構 | 多重邊 | 自環 |
|------|--------|------|
| 鄰接矩陣 | 需存計數 | A[i][i] |
| 鄰接串列 | 自然支援 | 自然支援 |
| 邊列表 | 自然支援 | 自然支援 |

## 考試重點

1. **基本操作**
   - 給定圖，寫出各種表示法
   - 分析操作的時間複雜度

2. **選擇題**
   - 何時使用哪種表示法
   - 空間複雜度比較

3. **與演算法結合**
   - BFS/DFS 使用哪種表示法較佳
   - Dijkstra、Kruskal 的表示法選擇

## 延伸閱讀

- CLRS Chapter 22.1: Representations of Graphs
- Goodrich Chapter 13: Graph Algorithms
- 圖演算法請參考 `tw-gradcs-algorithms` repository
